{"ast":null,"code":"import _toConsumableArray from\"/home/svina/twilio-video-react-hooks/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/svina/twilio-video-react-hooks/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import Video from'twilio-video';import Participant from'./Participant';var Room=function Room(_ref){var roomName=_ref.roomName,token=_ref.token,handleLogout=_ref.handleLogout;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),participants=_useState4[0],setParticipants=_useState4[1];useEffect(function(){var participantConnected=function participantConnected(participant){setParticipants(function(prevParticipants){return[].concat(_toConsumableArray(prevParticipants),[participant]);});};var participantDisconnected=function participantDisconnected(participant){setParticipants(function(prevParticipants){return prevParticipants.filter(function(p){return p!==participant;});});};Video.connect(token,{name:roomName}).then(function(room){setRoom(room);room.on('participantConnected',participantConnected);room.on('participantDisconnected',participantDisconnected);room.participants.forEach(participantConnected);});return function(){setRoom(function(currentRoom){if(currentRoom&&currentRoom.localParticipant.state==='connected'){currentRoom.localParticipant.tracks.forEach(function(trackPublication){trackPublication.track.stop();});currentRoom.disconnect();return null;}else{return currentRoom;}});};},[roomName,token]);var remoteParticipants=participants.map(function(participant){return/*#__PURE__*/React.createElement(Participant,{key:participant.sid,participant:participant});});return/*#__PURE__*/React.createElement(\"div\",{className:\"room\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Room: \",roomName),/*#__PURE__*/React.createElement(\"button\",{onClick:handleLogout},\"Log out\"),/*#__PURE__*/React.createElement(\"div\",{className:\"local-participant\"},room?/*#__PURE__*/React.createElement(Participant,{key:room.localParticipant.sid,participant:room.localParticipant}):''),/*#__PURE__*/React.createElement(\"h3\",null,\"Remote Participants\"),/*#__PURE__*/React.createElement(\"div\",{className:\"remote-participants\"},remoteParticipants));};export default Room;","map":{"version":3,"sources":["/home/svina/twilio-video-react-hooks/src/Room.js"],"names":["React","useState","useEffect","Video","Participant","Room","roomName","token","handleLogout","room","setRoom","participants","setParticipants","participantConnected","participant","prevParticipants","participantDisconnected","filter","p","connect","name","then","on","forEach","currentRoom","localParticipant","state","tracks","trackPublication","track","stop","disconnect","remoteParticipants","map","sid"],"mappings":"8TAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,cAAlB,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAuC,IAApCC,CAAAA,QAAoC,MAApCA,QAAoC,CAA1BC,KAA0B,MAA1BA,KAA0B,CAAnBC,YAAmB,MAAnBA,YAAmB,eAC1BP,QAAQ,CAAC,IAAD,CADkB,wCAC3CQ,IAD2C,eACrCC,OADqC,8BAEVT,QAAQ,CAAC,EAAD,CAFE,yCAE3CU,YAF2C,eAE7BC,eAF6B,eAIlDV,SAAS,CAAC,UAAM,CACd,GAAMW,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAAAC,WAAW,CAAI,CAC1CF,eAAe,CAAC,SAAAG,gBAAgB,qCAAQA,gBAAR,GAA0BD,WAA1B,IAAjB,CAAf,CACD,CAFD,CAIA,GAAME,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,CAAAF,WAAW,CAAI,CAC7CF,eAAe,CAAC,SAAAG,gBAAgB,QAC9BA,CAAAA,gBAAgB,CAACE,MAAjB,CAAwB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,GAAKJ,WAAV,EAAzB,CAD8B,EAAjB,CAAf,CAGD,CAJD,CAMAX,KAAK,CAACgB,OAAN,CAAcZ,KAAd,CAAqB,CACnBa,IAAI,CAAEd,QADa,CAArB,EAEGe,IAFH,CAEQ,SAAAZ,IAAI,CAAI,CACdC,OAAO,CAACD,IAAD,CAAP,CACAA,IAAI,CAACa,EAAL,CAAQ,sBAAR,CAAgCT,oBAAhC,EACAJ,IAAI,CAACa,EAAL,CAAQ,yBAAR,CAAmCN,uBAAnC,EACAP,IAAI,CAACE,YAAL,CAAkBY,OAAlB,CAA0BV,oBAA1B,EACD,CAPD,EASA,MAAO,WAAM,CACXH,OAAO,CAAC,SAAAc,WAAW,CAAI,CACrB,GAAIA,WAAW,EAAIA,WAAW,CAACC,gBAAZ,CAA6BC,KAA7B,GAAuC,WAA1D,CAAuE,CACrEF,WAAW,CAACC,gBAAZ,CAA6BE,MAA7B,CAAoCJ,OAApC,CAA4C,SAASK,gBAAT,CAA2B,CACrEA,gBAAgB,CAACC,KAAjB,CAAuBC,IAAvB,GACD,CAFD,EAGAN,WAAW,CAACO,UAAZ,GACA,MAAO,KAAP,CACD,CAND,IAMO,CACL,MAAOP,CAAAA,WAAP,CACD,CACF,CAVM,CAAP,CAWD,CAZD,CAaD,CAjCQ,CAiCN,CAAClB,QAAD,CAAWC,KAAX,CAjCM,CAAT,CAmCA,GAAMyB,CAAAA,kBAAkB,CAAGrB,YAAY,CAACsB,GAAb,CAAiB,SAAAnB,WAAW,qBACrD,oBAAC,WAAD,EAAa,GAAG,CAAEA,WAAW,CAACoB,GAA9B,CAAmC,WAAW,CAAEpB,WAAhD,EADqD,EAA5B,CAA3B,CAIA,mBACE,2BAAK,SAAS,CAAC,MAAf,eACE,uCAAWR,QAAX,CADF,cAEE,8BAAQ,OAAO,CAAEE,YAAjB,YAFF,cAGE,2BAAK,SAAS,CAAC,mBAAf,EACGC,IAAI,cACH,oBAAC,WAAD,EACE,GAAG,CAAEA,IAAI,CAACgB,gBAAL,CAAsBS,GAD7B,CAEE,WAAW,CAAEzB,IAAI,CAACgB,gBAFpB,EADG,CAMH,EAPJ,CAHF,cAaE,oDAbF,cAcE,2BAAK,SAAS,CAAC,qBAAf,EAAsCO,kBAAtC,CAdF,CADF,CAkBD,CA7DD,CA+DA,cAAe3B,CAAAA,IAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Video from 'twilio-video';\nimport Participant from './Participant';\n\nconst Room = ({ roomName, token, handleLogout }) => {\n  const [room, setRoom] = useState(null);\n  const [participants, setParticipants] = useState([]);\n\n  useEffect(() => {\n    const participantConnected = participant => {\n      setParticipants(prevParticipants => [...prevParticipants, participant]);\n    };\n\n    const participantDisconnected = participant => {\n      setParticipants(prevParticipants =>\n        prevParticipants.filter(p => p !== participant)\n      );\n    };\n\n    Video.connect(token, {\n      name: roomName\n    }).then(room => {\n      setRoom(room);\n      room.on('participantConnected', participantConnected);\n      room.on('participantDisconnected', participantDisconnected);\n      room.participants.forEach(participantConnected);\n    });\n\n    return () => {\n      setRoom(currentRoom => {\n        if (currentRoom && currentRoom.localParticipant.state === 'connected') {\n          currentRoom.localParticipant.tracks.forEach(function(trackPublication) {\n            trackPublication.track.stop();\n          });\n          currentRoom.disconnect();\n          return null;\n        } else {\n          return currentRoom;\n        }\n      });\n    };\n  }, [roomName, token]);\n\n  const remoteParticipants = participants.map(participant => (\n    <Participant key={participant.sid} participant={participant} />\n  ));\n\n  return (\n    <div className=\"room\">\n      <h2>Room: {roomName}</h2>\n      <button onClick={handleLogout}>Log out</button>\n      <div className=\"local-participant\">\n        {room ? (\n          <Participant\n            key={room.localParticipant.sid}\n            participant={room.localParticipant}\n          />\n        ) : (\n          ''\n        )}\n      </div>\n      <h3>Remote Participants</h3>\n      <div className=\"remote-participants\">{remoteParticipants}</div>\n    </div>\n  );\n};\n\nexport default Room;\n"]},"metadata":{},"sourceType":"module"}